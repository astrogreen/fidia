{% extends 'rest_framework/api.html' %}
{% load staticfiles %}
{% load rest_framework %}
{% load i18n %}
{% load internal_extras %}
{% block title %}Documentation{% endblock %}

{% block head-extra %}
<link rel="stylesheet" type="text/css" href="{% static 'restapi_app/less/documentation/documentation.css' %}"/>
{% endblock %}


<div class="container-fluid breadcrumb-container {% block breadcrumbclass %}{% endblock %}">
    <div class="container">
        {% block breadcrumbs-outer %}
        {% block breadcrumbs %}
        <ul class="breadcrumb ">
            <li><a href="{% url 'index' %}">Home</a></li>
            <li><a href="{% url 'documentation' %}">Documentation</a></li>
            <li class="active"><a href="{% url 'documentation-query-builder' %}">Query Builder</a></li>
        </ul>
        {% endblock %}
        {% endblock %}
    </div>
</div>

{% block content %}
<h1 class="headline">
    <span>Documentation</span>
</h1>
<div class="">
    <div class="row">
        <!--Nav Bar -->
        <div class="col-sm-2">
            {% block documentation-nav %}
            {% include "restapi_app/documentation/nav.html" %}
            {% endblock %}
        </div>
        <!--Main Content -->
        <div class="col-sm-10 col-xs-12">

            <section id="docs-query" class="group">
                <h2 class="headline">
                    <span>Query Builder</span>
                </h2>
                <div id="docs-query-builder" class="subgroup">
                    <div class="row">
                        <div class="col-xs-12">
                            <p>
                                The <a href="{% url 'query-list' %}#query-builder-form">Query Builder</a> allows you to
                                construct complicated
                                queries on the database with ease without writing any
                                code. It provides available catalogues and columns easily
                                to reduce query mistakes and query construction time, allowing for
                                less SQL-writing and more data exploration.
                            </p>
                            <p><br>
                                Queries can be made on known survey objects or
                                at specific coordinates on the sky (RA, DEC). The query
                                builder is sufficient for most use cases, however particularly
                                complicated queries can be submitted via the <a
                                        href="{% url 'query-list' %}#post-object-form">SQL form</a>.
                            </p>
                        </div>
                    </div>

                    {% captureas imgpath %}{% static 'restapi_app/img/documentation/query/query-builder'
                    %}{%endcaptureas %}
                    <h3 id="query-builder-select">Selecting Catalogues</h3>
                    <div class="row">
                        <div class="col-sm-8 col-md-8">
                            <img src="{{imgpath}}2.png" class="img-responsive img-thumbnail">
                        </div>
                        <div class="col-sm-4 col-md-4">
                            <p>Select the catalogue you wish to query via the catalogue dropdown. If you are
                                looking for a particular catalogue, the
                                search bar can help. </p>

                        </div>
                    </div>
                    <br><br>
                    <div class="row">
                        <div class="col-sm-8 col-md-8">
                            <img src="{{imgpath}}3.png" class="img-responsive img-thumbnail">
                        </div>
                        <div class="col-sm-4 col-md-4">
                            <p>Available columns for the selected catalogue will be
                                shown in the columns dropdown.
                                If you are looking for a particular column, the
                                search bar can help. Multiple columns can be selected, or alternatively you can click
                                the

                                <button type="button btn-xs" class="helperButton" disabled="true">âœ“&nbsp;&nbsp;Select
                                    All
                                </button>
                                button.
                            </p>
                            <p>The Query Builder will provide warnings and errors if insufficient
                                information has been supplied (e.g., columns have not been selected). </p>
                        </div>
                    </div>
                    <br><br>
                    <div class="row">
                        <div class="col-sm-8 col-md-8">
                            <img src="{{imgpath}}4.png" class="img-responsive img-thumbnail">
                        </div>
                        <div class="col-sm-4 col-md-4">
                            <p>
                                The Query Builder will automatically generate the SQL for valid selections.
                                The
                                <button class="btn btn-default btn-xs" disabled style="opacity:1"><i
                                        class="fa fa-code"></i> UPDATE
                                </button>
                                button
                                will re-generate the SQL if you have changed the form input. Check the SQL is as you
                                would expect before hitting the
                                <button class="btn btn-primary btn-xs" disabled style="opacity:1"><i
                                        class="fa fa-code"></i> SEND TO FORM
                                </button>
                                button
                            </p>
                        </div>
                    </div>
                    <br><br>
                    <h3 id="query-builder-join">Joining Catalogues</h3>
                    <div class="row">
                        <div class="col-sm-8 col-md-8">
                            <img src="{{imgpath}}5.png" class="img-responsive img-thumbnail">
                        </div>
                        <div class="col-sm-4 col-md-4">
                            <p>
                                Multiple catalogues can be added using the <i class="black fa fa-plus"></i>
                                Add Field button (circled in green). Remove catalogues using the <i
                                    class="black fa fa-times"></i>
                                Remove Field button.
                            </p>
                        </div>
                    </div>
                    <br><br>
                    <div class="row">
                        <div class="col-sm-8 col-md-8">
                            <img src="{{imgpath}}10.png" class="img-responsive img-thumbnail">
                        </div>
                        <div class="col-sm-4 col-md-4">
                            <p> Use the Join row to specify how the catalogues are related.
                                In the example above, we will return all rows that have a CATAID that exists in
                                both SpecObj AND InputCatA catalogues.</p>
                        </div>
                    </div>
                    <br><br>
                    <div class="row">
                        <div class="col-xs-12">
                            Supported join types are detailed below.
                            <table class="table table-bordered">
                                <thead>
                                <tr>
                                    <th>
                                        Join
                                    </th>
                                    <th>
                                        Description
                                    </th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <td>
                                        <samp>INNER</samp>
                                    </td>
                                    <td>
                                        Limited to the rows that exist in both tables. For example,
                                        in our join above, a <samp>CATAID</samp> that
                                        appears in both <samp>InputCatA</samp> and <samp>SpecObj</samp> catalogues
                                        would be returned, however if a <samp>CATAID</samp>
                                        appeared in only one of <samp>InputCatA</samp> and <samp>SpecObj</samp>,
                                        it would not be returned. If you are unsure which join
                                        type to select, <samp>INNER</samp> is usually the best option.
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <samp>LEFT</samp>
                                    </td>
                                    <td>
                                        All rows from the first (or left hand side) catalogue
                                        are preserved. Rows from the right hand catalogue will
                                        be returned <em>only</em> if they have a match in the
                                        left catalogue. Where there are values from the left
                                        catalogue and not the right, values will be set as
                                        <samp>NULL</samp>.
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <samp>RIGHT</samp>
                                    </td>
                                    <td>
                                        All rows from the second (or right hand side) catalogue
                                        are preserved. Rows from the left hand catalogue will be
                                        returned <em>only</em> if they have a match in the right
                                        catalogue. Where there are values from the right catalogue
                                        and not the left, values will be set as <samp>NULL</samp>.
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <samp>OUTER</samp>
                                    </td>
                                    <td>
                                        A full outer join returns all rows from both catalogues,
                                        regardless of whether there are any matches. As in the
                                        <samp>LEFT</samp> and <samp>RIGHT</samp> joins, empty
                                        values will be set at NULL.
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <br><br>
                    <h3 id="query-builder-where">Adding Filters</h3>
                    <div class="row">
                        <div class="col-sm-8 col-md-8">
                            <img src="{{imgpath}}-11.png" class="img-responsive img-thumbnail">
                        </div>
                        <div class="col-sm-4 col-md-4">
                            <p>Set the constraints that determine which rows of the
                            above catalogues(s) will be returned by your query. Leaving this
                                empty will simply return all rows.</p>
                            <p> Multiple filters can be added using the <i class="black fa fa-plus"></i>
                                Add Field button (circled in green). Remove filters using the <i
                                        class="black fa fa-times"></i>
                                Remove Field button.</p>
                        </div>
                    </div>
                    <br><br>
                    <h3 id="query-builder-schema">Schema Browser</h3>
                    <div class="row">
                        <div class="col-sm-8 col-md-8">
                            <img src="{{imgpath}}0big.png" class="img-responsive img-thumbnail" style="padding:0">
                        </div>
                        <div class="col-sm-4 col-md-4">
                            <p>Use the Schema Browser to explore the available data and build a meaningful
                                query. Click a catalogue in the dropdown to view its meta data.

                                Where available, additional dropdowns will appear allowing you to view the
                                column meta data.
                            </p>
                            <p>
                                The Schema Browser content is provided by the survey teams, if you
                                find any of this information incorrect or unclear, please either contact <a
                                    href="mailto:asvo@aao.gov.au"> us</a> or the email provided in the
                                <strong>Contact</strong>
                                field.
                            </p>
                        </div>
                    </div>
                    <br><br>
                    <h3 id="query-builder-faq">FAQ</h3>
                    <div class="row">
                        <div class="col-xs-12">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h3 class="panel-title">1.
                                        The
                                        <button class="btn btn-primary btn-xs" disabled style="opacity:1"><i
                                                class="fa fa-code"></i> SEND TO FORM
                                        </button>
                                        button is disabled. How can I submit the form?
                                    </h3>
                                </div>
                                <div class="panel-body">
                                    answer
                                </div>
                            </div>
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h3 class="panel-title">2.
                                        The
                                        <button class="btn btn-primary btn-xs" disabled style="opacity:1"><i
                                                class="fa fa-code"></i> SEND TO FORM
                                        </button>
                                        button is disabled. How can I submit the form?
                                    </h3>
                                </div>
                                <div class="panel-body">
                                    answer
                                </div>
                            </div>


                        </div>
                    </div>
                    <h3 id="query-builder-examples">Examples</h3>


                </div>

            </section>

        </div>
    </div>
</div>
{% endblock %}
{% block footer-extra %}
<script>
    $(document).ready(function () {
        //DOCS
        $('body').scrollspy({
            target: '.docs-sidebar',
            offset: 40
        });
    });
</script>
{% endblock %}