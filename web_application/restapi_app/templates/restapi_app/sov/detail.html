{% extends 'rest_framework/api.html' %}
{% load staticfiles %}
{% load rest_framework %}
{% load i18n %}
{% load internal_extras %}
{% block title %}{{objname}}{% endblock %}
{% block head-extra %}
<link rel="stylesheet" type="text/css" href="{% static 'restapi_app/css/sov/sov.css' %}"/>
{% endblock %}

{% block content %}
    <!--{{ request.build_absolute_uri }}{{ object.get_absolute_url }}-->
    {% comment %}
        {% for key, value in response.data.items %}
                {{ key }}: {{value|ValueType}}<br>
        {% endfor %}
    {% endcomment %}
    <h1 class="headline">
        <span>{{ objname }}</span>
    </h1>

    <div class="row">
        <div class="col-xs-12">
            <div class="tabbable" id="SOV">
                <ul class="nav nav-tabs">
                    <li > <a name="Profile-tab" href="#Profile-SOV" data-toggle="tab" >Profile</a></li>
                    <li> <a name="GAMA-tab" href="#GAMA-SOV" data-toggle="tab" aria-expanded="true">GAMA</a> </li>
                    <li class="active"> <a name="SAMI-tab" href="#SAMI-SOV" data-toggle="tab">SAMI</a> </li>
                </ul>
                <div class="well tab-content">
                    <div class="tab-pane " id="Profile-SOV">
                        <div class="row">
                            <div class="col-sm-6">
                                <table class="table">
                                    <thead>
                                        <tr><th>ASVOID</th></tr>
                                    </thead>
                                    <tr>
                                        <tr><td>{{response.data.asvo_id}}</td></tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="col-sm-6">
                                <div class="thumbnail">
                                  <img src="http://casjobs.sdss.org/ImgCutoutDR7/getjpeg.aspx?ra={{response.data.ra}}&dec={{response.data.dec}}&scale=0.2&opt=IGPO&width=512&height=512" alt="..." class="img-responsive">
                                  <div class="caption">
                                    <h3>SDSS Image</h3>
                                    <p>False colour, 512 × 512 pixel, 0.2 arcsec/pixel, 5-band composite from SDSS DR7.</p>
                                  </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane" id="GAMA-SOV">
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="row">
                                    <div class="col-xs-4">
                                        {% with 'restapi_app/img/logo/logo-'|add:'gama'|add:'.png' as image_static %}
                                            <img class="img-responsive pull-left gama sov-logo" src="{% static image_static %}">
                                        {% endwith %}
                                    </div>
                                    <div class="col-xs-8">
                                        <table class="table table-condensed">
                                            <thead><tr><th>CATAID</th><th>RA</th><th>DEC (J2000)</th></tr></thead>
                                            <tbody>
                                            <tr>
                                                <td>{{response.data.InputCatA.CATAID}}</td>
                                                <td>{{response.data.InputCatA.RA}}</td>
                                                <td>{{response.data.InputCatA.DEC}}</td>
                                            </tr></tbody>
                                        </table>
                                    </div>
                                </div>
                                <!--<div class="thumbnail">-->
                                  <!--<img src="{{ response.data.Spectrum }}" alt="..." class="img-responsive">-->
                                  <!--<div class="caption">-->
                                    <!--<h3>G{{response.data.InputCatA.CATAID}}</h3>-->
                                    <!--<p>SPECID = {{response.data.SpecAll.SPECID}}</p>-->
                                  <!--</div>-->
                                <!--</div>-->
                            </div>
                            <div class="col-sm-12">
                                <div class="panel panel-default">
                                    <div class="panel-heading"><h3 class="panel-title">InputCatA</h3></div>
                                    <div class="table-responsive">
                                        <table class="table table-bordered">
                                            <thead>
                                                <tr>
                                                {% for k,v in response.data.InputCatA.items %}
                                                    <th>{{ k }}</th>
                                                {% endfor %}
                                                </tr>
                                            </thead>
                                            <tbody>
                                            <tr>
                                                {% for k,v in response.data.InputCatA.items %}
                                                    <td>{{ v }}</td>
                                                {% endfor %}
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <br>
                            <div class="col-sm-6">
                                <div class="panel panel-default">
                                  <div class="panel-heading">
                                    <h3 class="panel-title">Catalogues</h3>
                                  </div>
                                  <div class="panel-body">
                                      {% for k in response.data.CatList %}
                                      <div class="row">
                                      <div class="col-xs-4">
                                        <code>{{ k }}</code>
                                      </div>
                                      <div class="col-xs-4">
                                        <p></p>
                                      </div>
                                      </div>
                                      {% endfor %}
                                  </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="panel panel-default">
                                  <div class="panel-heading">
                                    <h3 class="panel-title">TilingCat</h3>
                                  </div>
                                  <div class="panel-body">
                                    <dl class="dl-horizontal">
                                        {% for k,v in response.data.TilingCat.items %}
                                        <dt>{{ k }}</dt>
                                        <dd>{{ v }}</dd>
                                        {% endfor %}
                                    </dl>
                                  </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane active" id="SAMI-SOV">
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="row">
                                    <div class="col-xs-4">
                                        {% with 'restapi_app/img/logo/logo-'|add:'sami'|add:'.png' as image_static %}
                                            <img class="img-responsive pull-left sami sov-logo" src="{% static image_static %}">
                                        {% endwith %}
                                    </div>
                                    <div class="col-xs-8">
                                        <table class="table table-condensed">
                                            <thead><tr><th>SAMI ID</th><th>RA</th><th>DEC (J2000)</th><th>Redshift</th></tr></thead>
                                            <tbody>
                                            <tr>
                                                <td><a href="{% url "sami-list" %}{{response.data.samiID}}"> {{response.data.samiID}}</a></td>
                                                <td>{{response.data.ra}}</td>
                                                <td>{{response.data.dec}}</td>
                                            </tr></tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="row">
                                    {% for key, value in response.data.items %}
                                        {% if key == "velocity_map" %}
                                        <div class="col-xs-12 col-sm-4">
                                            <h4>
                                                <a href="{% url "sami-list" %}{{objname}}/{{key}}"> {{ key | CapsSentence }}</a>
                                            </h4>
                                            <div id="{{ key }}">test</div>
                                        </div>
                                        {% endif %}
                                    {% endfor %}
                                    {% for key, value in response.data.items %}
                                        {% if "line_map" in key %}
                                        <div class="col-xs-12 col-sm-4 col-md-4">
                                            <h4>
                                                <a href="{% url "sami-list" %}{{objname}}/{{key}}"> {{ key | CapsSentence }}</a>
                                            </h4>
                                            <div id="{{ key }}">test</div>
                                        </div>
                                        {% endif %}
                                    {% endfor %}
                                    <hr>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-offset-8 col-sm-4">
            {% if 'GET' in allowed_methods %}
                <form id="get-form" >
                    <fieldset>
                        {% if api_settings.URL_FORMAT_OVERRIDE %}
                        <div class="btn-group  btn-block format-selection">
                            <!--<a class="btn btn-default btn-block btn-md js-tooltip" href="{{ request.get_full_path }}" rel="nofollow"-->
                               <!--title="Download user {{user}}'s {{ name }} by format type">Download list of {{objname}} objects</a>-->
                            <button class="btn btn-default btn-block btn-md dropdown-toggle js-tooltip" data-toggle="dropdown" title="Specify a format for the request">
                                Download Data for {{objname}}  <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu">
                                {% for format in available_formats %}
                                <li>
                                    <a class="js-tooltip format-option" href="{% add_query_param request api_settings.URL_FORMAT_OVERRIDE format %}"
                                       rel="nofollow" title="Download {{ name }} with the format set to `{{ format }}`">{{ format }}</a>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                        {% else %}
                            <a class="btn btn-default btn-sm js-tooltip" href="{{ request.get_full_path }}" rel="nofollow"
                               title="View user {{user}}'s {{ name }}">GET</a>
                        {% endif %}
                    </fieldset>
                </form>
            {% endif %}
        </div>
    </div>

{% endblock %}


{% block footer-extra %}
<script src="{% static 'restapi_app/js/plotly/plotly.min.js' %}"></script>
<script src="{% static 'restapi_app/js/jsonparsemore/json_parseMore.js' %}"></script>

 <script type="text/javascript"> 
        //make astroobject available as json
        var AstroObjectJson = JSON.parseMore("{{ content|escapejs }}");

        console.log(AstroObjectJson.velocity_map.value)
    </script>
<script src="{% static 'restapi_app/js/sov/2DHistogram.js' %}"></script>
{% endblock %}