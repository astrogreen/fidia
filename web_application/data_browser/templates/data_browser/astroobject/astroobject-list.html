{% extends 'rest_framework/api.html' %}
{% load staticfiles %}
{% load rest_framework %}
{% load i18n %}
{% load internal_extras %}
{% block title %}{{objname}}{% endblock %}
{% block head-extra %}
<link rel="stylesheet" type="text/css" href="{% static 'data_browser/css/sample/sample.min.css' %}"/>
{% endblock %}
{% block bodyclass %}{% endblock %}
{% block breadcrumbclass %}{% endblock %}

{% block content-options %}{% endblock %}
{% block content-delete %}{% endblock %}
{% block content-filter-form %}{% endblock %}

{% block content-page-header %}{% endblock %}

{% block content_render %}
<div class="row">
    <div class="col-sm-12"></div>
</div>

    <div class="row">
        <div class="col-sm-12">
            <h1 class="headline">
                <span>{{ objname }}</span>
                {% captureas survey %}{% get_pks request.path -3 %}{% endcaptureas %}
                {% surveylogoimglink survey %}
            </h1>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <div class="panel panel-default">
                <div class="panel-body">
                    <p><strong>{{ objname }}</strong></p>
                    <p>Key info (ra, dec, etc)</p>
                </div>
            </div>
        </div>
    </div>

    {% for trait_type in response.data.trait_list %}
         {% if forloop.first %} <div class="row"> {% endif %}
            <div class="col-md-3 col-sm-3 col-xs-6">
                <h3 class="headline"><span>{{trait_type | CapsSentence}}</span></h3>
                <!--Accordion-->
                <div class="panel-group" id="accordion_{{trait_type}}" role="tablist" aria-multiselectable="true">
                    {% for trait_name, value in response.data.schema.items %}
                        {% if trait_type in trait_name %}
                            <div class="panel panel-default">
                                <div class="panel-heading panel-background-grey" role="tab" id="heading_{{trait_name}}">
                                    <a role="button" data-toggle="collapse" data-parent="#accordion_{{trait_type}}"
                                       href="#collapse_{{trait_name}}"
                                       aria-expanded="false" aria-controls="collapse_{{trait_name}}" style="font-weight: 300; font-size: 16px;">
                                        <span>{{trait_name | CapsSentence}}</span>
                                    </a>
                                    <a href="{{ trait_name }}" class="pull-right" style="color: #a30000;">
                                        view
                                    </a>

                                </div>
                                <div id="collapse_{{trait_name}}" class="panel-collapse collapse" role="tabpanel"
                                     aria-labelledby="heading_{{trait_name}}">
                                    <div class="panel-body">
                                        <h6 class="text-uppercase">Properties</h6>
                                        {% for trait_property_name, trait_property_value in value.items %}
                                            <a href="{{ trait_name }}/{{ trait_property_name }}" class="inline-links"><p>{{ trait_property_name }}</p></a>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>

                        {% endif %}

                    {% endfor %}

                </div>

            </div>
         {% if forloop.counter|divisibleby:4 %}</div><div class="row">{% endif %}
         {% if forloop.last %}</div>{% endif %}
    {% endfor %}


    <!--<div class="row">-->
        <!--<div class="col-sm-8">-->
            <!--<table>-->
            <!--{% for key, value in response.data.schema.items %}-->
                <!--<tr style="border-bottom:blue 1px solid;"><td>{{key}}</td><td> {{value}}</td></tr>-->
            <!--{% endfor %}-->
            <!--</table>-->
        <!--</div>-->
    <!--</div>-->

{% endblock %}

{% block content-DRFs %}{% endblock %}
{% block footer-extra %}
<script type="application/javascript">
    var trait_list = {{response.data.trait_list | safe }};

    function myfunction(item, index){
        // Open up accordion for first panel in each column
        $('#accordion_'+item+' .panel:first-of-type .panel-title a').attr('aria-expanded', true);
        $('#accordion_'+item+' .panel:first-of-type .panel-collapse.collapse').addClass('in');

    }

    trait_list.forEach(myfunction);


</script>
{% endblock %}

