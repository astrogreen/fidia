{% extends 'base/base.html' %}
{# Load the tag library #}
{% load asvo_tags %}
{% load mathfilters %}
{% load bootstrap3 %}

{# Load CSS and JavaScript #}
{% bootstrap_css %}
{% bootstrap_javascript %}

{# Display django.contrib.messages as Bootstrap alerts #}
{% bootstrap_messages %}

{% block title %} Query Form {% endblock %}
{% block wrapper %}
    <div class="container">
        <div class="row">
            <h2>Query</h2>
            <div class="col-sm-12">
                <div class="form-container">
                <h4>Selection Criteria</h4>
                <form action="" method="post" class="form" role="form">
                    {% csrf_token %}
                    <!--{% bootstrap_form form layout="horizontal" %}-->
                    <!--{% buttons submit='Submit' reset='Reset' layout='horizontal' %}{% endbuttons %}-->
                    <div id="returnWrapper">
                        <div class="form-group">
                            <label for="cat" class="col-sm-1 control-label">Select</label>
                            <div id="return-fields" class="col-sm-11">
                                    {% for fields in form %}
                                        {% with forloop.counter|sub:1 as i %}
                                        {% with forloop.counter|sub:1|intdiv:2 as j %}
                                        {% if j < hiddenFields %}
                                            {% if i|divisibleby:2 == True %}
                                                <div id="return-input{{ j }}" class="return-input">
                                            {% endif %}
                                            <div class="col-sm-5">
                                                {% bootstrap_field fields show_label=False %}
                                            </div>
                                            {% if i|divisibleby:2 == False %}
                                                    <div class="col-sm-2">
                                                        <span class="input-group-btn">
                                                            {% if j == 0 %}
                                                              <button type="button" class="btn btn-xs add-field">
                                                                  <span class="glyphicon glyphicon-plus"></span>
                                                              </button>
                                                            {% else %}
                                                                <button type="button" class="btn btn-danger btn-xs remove-field">
                                                                  <span class="glyphicon glyphicon-minus"></span>
                                                              </button>
                                                            {% endif %}
                                                      </span>
                                                    </div>
                                                </div>
                                            {% endif %}
                                        {% else %}
                                            <div class="col-sm-3">
                                                {% bootstrap_field fields show_label=False %}
                                            </div>
                                        {% endif %}
                                        {% endwith %}
                                        {% endwith %}
                                    {% endfor %}

                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <!--<div class="col-sm-1 "><button class="btn pull-right" type="reset">Reset</button></div>-->
                        <div class="col-sm-12"><button class="btn pull-right" type="submit">Submit</button></div>
                    </div>
                </form>
                </div>
                <!-- Modal -->
                <div class="modal fade" id="maxFieldsModal" role="dialog">
                    <div class="modal-dialog">

                      <!-- Modal content-->
                      <div class="modal-content">
                        <div class="modal-header">
                          <button type="button" class="close" data-dismiss="modal">&times;</button>
                          <h4 class="modal-title">Warning</h4>
                        </div>
                        <div class="modal-body">
                          <p>Maximum number of fields allowed. Please use the SQL input box for a more sophisticated query.</p>
                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                      </div>

                    </div>
                </div>
            </div>
            <div class=" col-sm-12">
                <h4>Result</h4>
                <div class="well well-sm">
                 {% if message %}<p>{{ message }}</p>{% endif %}<br>
                </div>
                <h4>Error</h4>
                <div class="well well-sm">
                 {% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}<br>
                </div>
            </div>
        </div>
    </div>
{% endblock %}